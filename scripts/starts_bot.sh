#!/bin/bash

################# –û–ø—Ä–µ–¥–µ–ª–∏–º –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ ###########################

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(dirname "$SCRIPT_DIR")"
MAIN="$PROJECT_ROOT/src/pizzeria_bot/app.py"
ENV_FILE="$PROJECT_ROOT/src/pizzeria_bot/.env"

echo "üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ '–ü–∏—Ü—Ü–µ—Ä–∏—è –¢–∞–π–≥–∏'..."

################# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ app.py ###########################

if [ ! -f "$MAIN" ]; then
    echo "‚ùå –û—à–∏–±–∫–∞: –ù–µ –Ω–∞–π–¥–µ–Ω —Ñ–∞–π–ª $MAIN"
    exit 1
fi

################# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ .env ###########################

if [ ! -f "$ENV_FILE" ]; then
    echo "‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ: –ù–µ –Ω–∞–π–¥–µ–Ω —Ñ–∞–π–ª .env –ø–æ –ø—É—Ç–∏ $ENV_FILE"
    echo "–°–æ–∑–¥–∞–π –µ–≥–æ, –∏–Ω–∞—á–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è."
else
    echo "‚úÖ –ù–∞–π–¥–µ–Ω .env —Ñ–∞–π–ª"
fi

################# –ó–∞–ø—É—Å–∫ ###########################

echo "üß† –ó–∞–ø—É—Å–∫–∞–µ–º —á–µ—Ä–µ–∑ Poetry..."
cd "$PROJECT_ROOT"
poetry run python3 "$MAIN"
